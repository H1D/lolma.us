<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    
<meta name="lolma-us/config/environment" content="%7B%22modulePrefix%22%3A%22lolma-us%22%2C%22podModulePrefix%22%3A%22lolma-us/pods%22%2C%22environment%22%3A%22production%22%2C%22rootURL%22%3A%22/%22%2C%22locationType%22%3A%22auto%22%2C%22envVars%22%3A%7B%22LMS_GITHUB_CLIENT_ID%22%3A%224da52fd7973591d437ea%22%2C%22LMS_ROLLBAR_CLIENT_ID%22%3A%224c6c03ad77a74b16bc4bb6a7b4726bde%22%2C%22LMS_HOST%22%3A%22https%3A//lolma.us%22%2C%22LMS_GATEKEEPER_URL%22%3A%22https%3A//lolma-us-prod.herokuapp.com%22%7D%2C%22EmberENV%22%3A%7B%22FEATURES%22%3A%7B%7D%2C%22EXTEND_PROTOTYPES%22%3A%7B%22Date%22%3Afalse%7D%7D%2C%22APP%22%3A%7B%22name%22%3A%22lolma-us%22%2C%22version%22%3A%220.0.0+1b57ddef%22%7D%2C%22emberRollbarClient%22%3A%7B%22enabled%22%3Atrue%2C%22accessToken%22%3A%224c6c03ad77a74b16bc4bb6a7b4726bde%22%2C%22verbose%22%3Atrue%2C%22captureUncaught%22%3Atrue%2C%22captureUnhandledRejections%22%3Atrue%2C%22payload%22%3A%7B%22environment%22%3A%22production%22%2C%22client%22%3A%7B%22javascript%22%3A%7B%22source_map_enabled%22%3Atrue%2C%22code_version%22%3A%220.0.0+1b57dde%22%2C%22guess_uncaught_frames%22%3Atrue%7D%7D%7D%7D%2C%22i18n%22%3A%7B%22defaultLocale%22%3A%22en%22%7D%2C%22fastboot%22%3A%7B%22hostWhitelist%22%3A%5B%22/%22%2C%22http%3A//127.0.0.1%3A8081%22%5D%7D%2C%22torii%22%3A%7B%22providers%22%3A%7B%22github-oauth2%22%3A%7B%22apiKey%22%3A%224da52fd7973591d437ea%22%2C%22scope%22%3A%22public_repo%22%7D%7D%7D%2C%22moment%22%3A%7B%22includeLocales%22%3A%5B%22ru%22%5D%7D%2C%22metricsAdapters%22%3A%5B%7B%22name%22%3A%22GoogleAnalytics%22%2C%22environments%22%3A%5B%22development%22%2C%22production%22%5D%2C%22config%22%3A%7B%22id%22%3A%22UA-77566978-1%22%2C%22sendHitTask%22%3Atrue%7D%7D%5D%2C%22disqus%22%3A%7B%22shortname%22%3A%22lolmaus%22%7D%2C%22LMS_GITHUB_CLIENT_ID%22%3A%224da52fd7973591d437ea%22%2C%22LMS_ROLLBAR_CLIENT_ID%22%3A%224c6c03ad77a74b16bc4bb6a7b4726bde%22%2C%22LMS_HOST%22%3A%22https%3A//lolma.us%22%2C%22LMS_GATEKEEPER_URL%22%3A%22https%3A//lolma-us-prod.herokuapp.com%22%2C%22exportApplicationGlobal%22%3Afalse%7D" />
<!-- EMBER_CLI_FASTBOOT_TITLE -->  <meta name="ember-cli-head-start">
<title>Do not confuse environment for deploy target | Blog | Andrey Mikhaylov (lolmaus)</title>
<meta property="og:title" content="Do not confuse environment for deploy target">

<!---->
  <meta property="og:locale" content="en">
  <link rel="alternate" type="application/rss+xml" href="https://lolma.us/rss_en.xml">

  <meta property="og:description" content="Most frameworks have a concept of *environment*. Many developers are misusing it as a deploy target.">

<meta property="og:image" content="https://lolma.us/favicon.jpg">

<meta property="og:type" content="article">

  <link rel="canonical" href="https://lolma.us/en/blog/do-not-confuse-env-for-deploy-target/">
  <meta property="og:url" content="https://lolma.us/en/blog/do-not-confuse-env-for-deploy-target/">
  <meta property="article:published_time" content="2017-02-18T00:00:00.000Z">
  <meta property="article:author" content="https://lolma.us/en/">

    <meta property="article:modified_time" content="2017-12-24T00:00:00.000Z">

<!---->
  <script type="application/ld+json">{"@context":"http://schema.org","@graph":[{"@type":"WebSite","image":"https://lolma.us/favicon.jpg","author":{"@type":"Person","name":"Andrey Mikhaylov","givenName":"Andrey","familyName":"Mikhaylov","additionalName":"lolmaus","email":"mailto:lolmaus@gmail.com","image":"https://lolma.us/favicon.jpg","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Moscow","availableLanguage":{"@type":"Language","name":["Russian"]}},"brand":{"@type":"Brand","name":"Helix TeamHub","logo":"https://lolma.us/images/linked-data/helix-teamhub-logo-0fe238b12e2dddfd8954425c9c94236a.png","url":"https://www.perforce.com/products/helix-teamhub","description":"Code Hosting and Collaboration for Git+"},"homeLocation":{"@type":"Place","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Moscow","availableLanguage":{"@type":"Language","name":["Russian"]}}},"jobTitle":["Frontend developer","EmberJS developer"],"memberOf":{"@type":"Organization","logo":"https://lolma.us/images/linked-data/perforce-logo.png","url":"https://www.perforce.com/","name":"Perforce","brand":[{"@type":"Brand","name":"Helix Core","logo":"https://lolma.us/images/linked-data/helix-core-logo-8c5164957fa78647968b2db6e0893567.png","url":"https://www.perforce.com/products/helix-core","description":"Version Control + Swarm Code Review &amp; Collaboration"},{"@type":"Brand","name":"Hansoft","logo":"https://lolma.us/images/linked-data/hansoft-logo-7658d48e82acda65c2106b2eba082e57.png","url":"https://hansoft.com/","description":"Agile Project &amp; Product Management Solution"},{"@type":"Brand","name":"Helix TeamHub","logo":"https://lolma.us/images/linked-data/helix-teamhub-logo-0fe238b12e2dddfd8954425c9c94236a.png","url":"https://www.perforce.com/products/helix-teamhub","description":"Code Hosting and Collaboration for Git+"},{"@type":"Brand","name":"Helix ALM","logo":"https://lolma.us/images/linked-data/helix-alm-logo-9b37cab7b9b913e82c6b38a99f43a4e2.png","url":"https://www.perforce.com/products/helix-alm","description":"Flexible, End-to-End Application Lifecycle Management"}]},"nationality":{"@type":"Country","name":"Russia","alternateName":"Russian Federation"}},"accessMode":"textual","inLanguage":"en","audience":{"@type":"Audience","audienceType":["developers","web developers","javascript developers","js developers","ember developers","emberjs developers"]},"license":{"@type":"CreativeWork","name":"Creative Commons Attribution 4.0 International","alternateName":"CC BY 4.0","url":"https://creativecommons.org/licenses/by/4.0/","description":"You are free to: Share — copy and redistribute the material in any medium or format; Adapt — remix, transform, and build upon the material for any purpose, even commercially). This license is acceptable for Free Cultural Works. The licensor cannot revoke these freedoms as long as you follow the license terms. Under the following terms: Attribution — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use. No additional restrictions — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits."}},{"@type":"Blog","author":{"@type":"Person","name":"Andrey Mikhaylov","givenName":"Andrey","familyName":"Mikhaylov","additionalName":"lolmaus","email":"mailto:lolmaus@gmail.com","image":"https://lolma.us/favicon.jpg","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Moscow","availableLanguage":{"@type":"Language","name":["Russian"]}},"brand":{"@type":"Brand","name":"Helix TeamHub","logo":"https://lolma.us/images/linked-data/helix-teamhub-logo-0fe238b12e2dddfd8954425c9c94236a.png","url":"https://www.perforce.com/products/helix-teamhub","description":"Code Hosting and Collaboration for Git+"},"homeLocation":{"@type":"Place","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Moscow","availableLanguage":{"@type":"Language","name":["Russian"]}}},"jobTitle":["Frontend developer","EmberJS developer"],"memberOf":{"@type":"Organization","logo":"https://lolma.us/images/linked-data/perforce-logo.png","url":"https://www.perforce.com/","name":"Perforce","brand":[{"@type":"Brand","name":"Helix Core","logo":"https://lolma.us/images/linked-data/helix-core-logo-8c5164957fa78647968b2db6e0893567.png","url":"https://www.perforce.com/products/helix-core","description":"Version Control + Swarm Code Review &amp; Collaboration"},{"@type":"Brand","name":"Hansoft","logo":"https://lolma.us/images/linked-data/hansoft-logo-7658d48e82acda65c2106b2eba082e57.png","url":"https://hansoft.com/","description":"Agile Project &amp; Product Management Solution"},{"@type":"Brand","name":"Helix TeamHub","logo":"https://lolma.us/images/linked-data/helix-teamhub-logo-0fe238b12e2dddfd8954425c9c94236a.png","url":"https://www.perforce.com/products/helix-teamhub","description":"Code Hosting and Collaboration for Git+"},{"@type":"Brand","name":"Helix ALM","logo":"https://lolma.us/images/linked-data/helix-alm-logo-9b37cab7b9b913e82c6b38a99f43a4e2.png","url":"https://www.perforce.com/products/helix-alm","description":"Flexible, End-to-End Application Lifecycle Management"}]},"nationality":{"@type":"Country","name":"Russia","alternateName":"Russian Federation"}},"accessMode":"textual","inLanguage":"en","audience":{"@type":"Audience","audienceType":["developers","web developers","javascript developers","js developers","ember developers","emberjs developers"]},"license":{"@type":"CreativeWork","name":"Creative Commons Attribution 4.0 International","alternateName":"CC BY 4.0","url":"https://creativecommons.org/licenses/by/4.0/","description":"You are free to: Share — copy and redistribute the material in any medium or format; Adapt — remix, transform, and build upon the material for any purpose, even commercially). This license is acceptable for Free Cultural Works. The licensor cannot revoke these freedoms as long as you follow the license terms. Under the following terms: Attribution — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use. No additional restrictions — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits."},"name":"Blog of Andrey Mikhaylov (lolmaus)","description":"Musings on web development, mostly on JavaScript and EmberJS","url":"https://lolma.us/en/blog/","keywords":["development","web development","webdev","ember","emberjs","js","javascript","frontend"]},{"@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"item":{"@id":"https://lolma.us/en/blog/","name":"Blog"}},{"@type":"ListItem","position":2,"item":{"@id":"https://lolma.us/en/blog/do-not-confuse-env-for-deploy-target/","name":"Do not confuse environment for deploy target"}}]},{"@type":"TechArticle","author":{"@type":"Person","name":"Andrey Mikhaylov","givenName":"Andrey","familyName":"Mikhaylov","additionalName":"lolmaus","email":"mailto:lolmaus@gmail.com","image":"https://lolma.us/favicon.jpg","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Moscow","availableLanguage":{"@type":"Language","name":["Russian"]}},"brand":{"@type":"Brand","name":"Helix TeamHub","logo":"https://lolma.us/images/linked-data/helix-teamhub-logo-0fe238b12e2dddfd8954425c9c94236a.png","url":"https://www.perforce.com/products/helix-teamhub","description":"Code Hosting and Collaboration for Git+"},"homeLocation":{"@type":"Place","address":{"@type":"PostalAddress","addressCountry":"Russia","addressLocality":"Moscow","availableLanguage":{"@type":"Language","name":["Russian"]}}},"jobTitle":["Frontend developer","EmberJS developer"],"memberOf":{"@type":"Organization","logo":"https://lolma.us/images/linked-data/perforce-logo.png","url":"https://www.perforce.com/","name":"Perforce","brand":[{"@type":"Brand","name":"Helix Core","logo":"https://lolma.us/images/linked-data/helix-core-logo-8c5164957fa78647968b2db6e0893567.png","url":"https://www.perforce.com/products/helix-core","description":"Version Control + Swarm Code Review &amp; Collaboration"},{"@type":"Brand","name":"Hansoft","logo":"https://lolma.us/images/linked-data/hansoft-logo-7658d48e82acda65c2106b2eba082e57.png","url":"https://hansoft.com/","description":"Agile Project &amp; Product Management Solution"},{"@type":"Brand","name":"Helix TeamHub","logo":"https://lolma.us/images/linked-data/helix-teamhub-logo-0fe238b12e2dddfd8954425c9c94236a.png","url":"https://www.perforce.com/products/helix-teamhub","description":"Code Hosting and Collaboration for Git+"},{"@type":"Brand","name":"Helix ALM","logo":"https://lolma.us/images/linked-data/helix-alm-logo-9b37cab7b9b913e82c6b38a99f43a4e2.png","url":"https://www.perforce.com/products/helix-alm","description":"Flexible, End-to-End Application Lifecycle Management"}]},"nationality":{"@type":"Country","name":"Russia","alternateName":"Russian Federation"}},"accessMode":"textual","inLanguage":"en","audience":{"@type":"Audience","audienceType":["developers","web developers","javascript developers","js developers","ember developers","emberjs developers"]},"license":{"@type":"CreativeWork","name":"Creative Commons Attribution 4.0 International","alternateName":"CC BY 4.0","url":"https://creativecommons.org/licenses/by/4.0/","description":"You are free to: Share — copy and redistribute the material in any medium or format; Adapt — remix, transform, and build upon the material for any purpose, even commercially). This license is acceptable for Free Cultural Works. The licensor cannot revoke these freedoms as long as you follow the license terms. Under the following terms: Attribution — You must give appropriate credit, provide a link to the license, and indicate if changes were made. You may do so in any reasonable manner, but not in any way that suggests the licensor endorses you or your use. No additional restrictions — You may not apply legal terms or technological measures that legally restrict others from doing anything the license permits."},"headline":"Do not confuse environment for deploy target","description":"Most frameworks have a concept of *environment*. Many developers are misusing it as a deploy target.","image":"https://lolma.us/favicon.jpg","datePublished":"2017-02-18T00:00:00.000Z","dateModified":"2017-12-24T00:00:00.000Z","proficiency":"beginner","mainEntityOfPage":{"@type":"WebPage","@id":"https://lolma.us/en/blog/do-not-confuse-env-for-deploy-target/"}}]}</script>
<meta name="ember-cli-head-end">


    <link integrity="" rel="stylesheet" href="/assets/vendor-10c46aeeb15514da80ccb4d3f41b4526.css">
    <link integrity="" rel="stylesheet" href="/assets/lolma-us-7bea756b2ad871bcdb1fb19ad6ecdba3.css">
    <link href="https://fonts.googleapis.com/css?family=PT+Sans+Caption|Merriweather:400,400i,700&amp;subset=cyrillic" rel="stylesheet">

    
  <link rel="yandex-tableau-widget" href="/yandex-browser-manifest.json">
<link rel="apple-touch-icon" sizes="57x57" href="/apple-touch-icon-57x57.png">
<link rel="apple-touch-icon" sizes="60x60" href="/apple-touch-icon-60x60.png">
<link rel="apple-touch-icon" sizes="72x72" href="/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon" sizes="76x76" href="/apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" sizes="114x114" href="/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon" sizes="120x120" href="/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" sizes="144x144" href="/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon" sizes="152x152" href="/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon-180x180.png">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<meta name="apple-mobile-web-app-title">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="shortcut icon" href="/favicon.ico">
<link rel="icon" type="image/png" sizes="228x228" href="/coast-228x228.png">
<link rel="manifest" href="/manifest.json">
<meta name="mobile-web-app-capable" content="yes">
<meta name="theme-color" content="#fff">
<meta name="application-name">
<meta name="msapplication-TileColor" content="#fff">
<meta name="msapplication-TileImage" content="/mstile-144x144.png">
<meta name="msapplication-config" content="/browserconfig.xml">
<link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 1)" href="/apple-touch-startup-image-320x460.png">
<link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 480px) and (-webkit-device-pixel-ratio: 2)" href="/apple-touch-startup-image-640x920.png">
<link rel="apple-touch-startup-image" media="(device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2)" href="/apple-touch-startup-image-640x1096.png">
<link rel="apple-touch-startup-image" media="(device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2)" href="/apple-touch-startup-image-750x1294.png">
<link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 3)" href="/apple-touch-startup-image-1182x2208.png">
<link rel="apple-touch-startup-image" media="(device-width: 414px) and (device-height: 736px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 3)" href="/apple-touch-startup-image-1242x2148.png">
<link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 1)" href="/apple-touch-startup-image-748x1024.png">
<link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 1)" href="/apple-touch-startup-image-768x1004.png">
<link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: landscape) and (-webkit-device-pixel-ratio: 2)" href="/apple-touch-startup-image-1496x2048.png">
<link rel="apple-touch-startup-image" media="(device-width: 768px) and (device-height: 1024px) and (orientation: portrait) and (-webkit-device-pixel-ratio: 2)" href="/apple-touch-startup-image-1536x2008.png">
</head>
  <body>
    <div id="ember2469" class="ember-view"><!---->

<div class="route-locale">

  <input type="checkbox" id="route-locale-menuToggler" class="route-locale-menuToggler ember-checkbox ember-view">

  <label for="route-locale-menuToggler" class="route-locale-burger">
    <svg height="25" viewBox="0 0 25 25" width="25" xmlns="http://www.w3.org/2000/svg" class="route-locale-burger-icon"><title/><path d="M0 2h25v4H0V2zm0 8h25v4H0v-4zm0 8h25v4H0v-4z" fill="#000" fill-rule="evenodd"/></svg>
  </label>

  <label for="route-locale-menuToggler" class="route-locale-backdrop"></label>



  <div id="ember2473" class="route-locale-menu sideMenu ember-view"><div class="route-locale-menu-greeting">
  You are awesome today!
  <span class="route-locale-menu-greeting-emoji">😎</span>
</div>

<div class="route-locale-menu-items">
<!---->
    <a href="/en" id="ember2478" class="route-locale-menu-item _resume ember-view">Résumé</a>

  <a href="https://github.com/lolmaus/lolma.us" class="route-locale-menu-item _source -no-icon">
    Source on GitHub
    <span class="externalLink"></span>
  </a>

<a href="/ru/blog/do-not-confuse-env-for-deploy-target" id="ember2487" class="route-locale-menu-item _locale ember-view">    Моя не понимать
</a></div></div>



  <div class="route-locale-content">
    <div class="route-blog">


<div id="ember2493" class="secTion ember-view"><div class="secTion-inner ">
      <div class="route-blog-sidebar">
      <div class="route-blog-sidebar-section _avatar">
        <img src="/favicon.jpg" alt="Andrey Mikhaylov" width="512" height="512" class="route-blog-sidebar-avatar">
      </div>

      <div class="route-blog-sidebar-section _content">
        <h2 class="route-blog-title">
          Andrey Mikhaylov
          @lolmaus
        </h2>

        <div class="route-blog-subtitle">
          frontend&nbsp;developer, EmberJS&nbsp;enthusiast
        </div>

        <div id="ember2506" class="route-blogIndex-menu horizontalMenu ember-view"><div class="horizontalMenu-item _blog">
  <a href="/en/blog" id="ember2507" class="horizontalMenu-item-link active ember-view">Blog</a>
</div>


<div class="horizontalMenu-item _resume">
  <a href="/en" id="ember2512" class="horizontalMenu-item-link ember-view">Résumé</a>
</div>


<div class="horizontalMenu-item _source">
  <a href="https://github.com/lolmaus/lolma.us" class="horizontalMenu-item-link -no-icon -has-inner">
    <span class="horizontalMenu-item-link-inner">Source on GitHub</span><span class="externalLink"></span>
  </a>
</div>


<div class="horizontalMenu-item _locale">
<a href="/ru/blog/do-not-confuse-env-for-deploy-target" id="ember2521" class="horizontalMenu-item-link ember-view">    Моя не понимать
</a></div></div>
      </div>
      
      <div class="route-blog-sidebar-section _bottom">

        <a href="https://creativecommons.org/licenses/by/4.0/" class="route-blog-sidebar-section-bottom-link -no-icon">
          <svg version="1" xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="5.5 -3.5 64 64" class="route-blog-sidebar-section-bottom-icon _cc" alt="License Creative Commons 4.0 Attribution" title="License Creative Commons 4.0 Attribution"><circle fill="#FFF" cx="37.637" cy="28.806" r="28.276"/><path d="M37.443-3.5c8.988 0 16.57 3.085 22.742 9.257C66.393 11.967 69.5 19.548 69.5 28.5c0 8.991-3.049 16.476-9.145 22.456-6.476 6.363-14.113 9.544-22.912 9.544-8.649 0-16.153-3.144-22.514-9.43C8.644 44.784 5.5 37.262 5.5 28.5c0-8.761 3.144-16.342 9.429-22.742C21.101-.415 28.604-3.5 37.443-3.5zm.114 5.772c-7.276 0-13.428 2.553-18.457 7.657-5.22 5.334-7.829 11.525-7.829 18.572 0 7.086 2.59 13.22 7.77 18.398 5.181 5.182 11.352 7.771 18.514 7.771 7.123 0 13.334-2.607 18.629-7.828 5.029-4.838 7.543-10.952 7.543-18.343 0-7.276-2.553-13.465-7.656-18.571-5.104-5.104-11.276-7.656-18.514-7.656zm8.572 18.285v13.085h-3.656v15.542h-9.944V33.643h-3.656V20.557c0-.572.2-1.057.599-1.457.401-.399.887-.6 1.457-.6h13.144c.533 0 1.01.2 1.428.6.417.4.628.886.628 1.457zm-13.087-8.228c0-3.008 1.485-4.514 4.458-4.514s4.457 1.504 4.457 4.514c0 2.971-1.486 4.457-4.457 4.457s-4.458-1.486-4.458-4.457z"/></svg>
        </a>

        <a href="https://lolma.us/rss_en.xml" class="route-blog-sidebar-section-bottom-link -no-icon">
          <svg xmlns="http://www.w3.org/2000/svg" height="49.25" viewBox="0 0 49.249999 49.249999" width="49.25" class="route-blog-sidebar-section-bottom-icon _rss" alt="RSS" title="RSS"><path d="M24.625 0C11.025 0 0 11.025 0 24.625 0 38.227 11.024 49.25 24.625 49.25c13.602 0 24.625-11.023 24.625-24.625C49.25 11.025 38.226 0 24.625 0zm-7.637 35.735a3.238 3.238 0 1 1 .002-6.476 3.238 3.238 0 0 1-.002 6.476zm8.123.021c0-3.057-1.182-5.928-3.33-8.082a11.247 11.247 0 0 0-8.028-3.342v-4.674c8.84 0 16.03 7.223 16.03 16.098h-4.672zm8.256.004c0-10.867-8.795-19.711-19.606-19.711v-4.676c13.387 0 24.28 10.942 24.28 24.387h-4.674z"/></svg>
        </a>
      </div>
      
    </div>

</div></div>

<div id="ember2534" class="route-blog-content secTion ember-view"><div class="secTion-inner route-blog-content-inner">
      <div class="route-blogPost">

  <a href="/en/blog" id="ember2536" class="route-blogPost-back active ember-view">← To blog index</a>

  <div id="ember2541" class="route-blogPost-post blogPost -full ember-view">  <h1 id="ember2542" class="blogPost-title ember-view"><p>Do not confuse environment for deploy target</p>
</h1>



<p class="blogPost-date">
  18th February 2017

    (last updated at 24th December 2017)

</p>



  <div id="ember2547" class="blogPost-summary ember-view"><p>Most frameworks have a concept of <em>environment</em>. Many developers are misusing it as a deploy target.</p>
</div>



  <div id="ember2548" class="blogPost-body ember-view"><div class="exclamation"></div>
<blockquote>
  <p>This article was originally posted on Deveo blog.</p>
  <p>When Deveo was acquired by Perforce, Deveo blog was turned down.</p>
</blockquote>
<p>I'm seeing the term <strong>environment</strong> used as a synonym of <strong>deploy target</strong> all the time. I believe, it causes a lot of confusion, and I would like clear it up.</p>
<p>This article is written with the <strong>EmberJS</strong> frontend framework in mind, but the idea is applicable to any other web framework, both frontend and backend.</p>
<h2 id="the-term-environment-is-too-vague" class="headingWithLink"><a href="#the-term-environment-is-too-vague" class="headingWithLink-link">#</a>The term Environment is too vague</h2>
<p>There are many articles on the web that may seem to contradict to what I'm gonna say, especially if you skim them without giving them deep consideration. Those articles have been frustrating to me for a long time, until I figured that the problem is that terminology is confusing.</p>
<p>In <strong>EmberJS</strong> and many other web frameworks the term <strong>environment</strong> is used in a narrow meaning, and I'm gonna use this very meaning below. <strong>Environment</strong> is a collection of parameters that configure how your wep app is built and run, such as:</p>
<ul>
<li>code minification,</li>
<li>asset fingerprinting/cache busting,</li>
<li>source map generation,</li>
<li>various debugging tools,</li>
<li>testing,</li>
<li>applying code coverage markers,</li>
<li>removing test selectors from HTML.</li>
</ul>
<p>There is another category of parameters, that is commonly referenced as <strong>environment</strong>. I believe that's a terrible mistake, and the second category must be distinguished from <strong>environment</strong>.</p>
<p>I call it <strong>deploy target</strong>. It includes the following params:</p>
<ul>
<li>API URLs,</li>
<li>CDN URLs,</li>
<li>CSP/CORS configuration,</li>
<li>API keys.</li>
</ul>
<h2 id="why-is-mixing-these-categories-a-problem" class="headingWithLink"><a href="#why-is-mixing-these-categories-a-problem" class="headingWithLink-link">#</a>Why is mixing these categories a problem?</h2>
<p>Many developers put those two categories of params into one pile and make them depend on the <strong>environment</strong> variable, which in most frameworks can have one of three values: <code>development</code>, <code>production</code> and <code>test</code>.</p>
<p>As a result, the app essentially has only two modes:</p>
<ul>
<li>production build to production server,</li>
<li>development build to development server.</li>
</ul>
<p>A necessity to deploy a development build to a production server is not rare. You typically need that to debug a problem that only manifestates on the server and can't be reproduced locally.</p>
<p>The opposite is also sometimes necessary: to make a production build against a local server. It can help you to benchmark your app's performance or to debug a problem with minification/fingerprinting.</p>
<p>When you have your <strong>environment</strong> and <strong>deploy target</strong> hard-wired, the only way to decouple them is to edit your configuration files by hand, make the unusual build, then undo your changes and make sure you don't accidentally commit them.</p>
<p>The worst part is that API keys are typically stored in your VCS, which is a security issue.</p>
<h2 id="the-right-way-to-do-it" class="headingWithLink"><a href="#the-right-way-to-do-it" class="headingWithLink-link">#</a>The right way to do it</h2>
<p>I recommend you to use <em>dotenv</em> files.</p>
<p>Dotenv files are configuration files with names that start with <code>.env-</code> prefix. They store environment variable definitions as key=value pairs, one per line:</p>
<div class="code-block"><pre><code class="hljs">FOO=bar
BAZ=quux</code></pre></div>
<p>Your app will read one of those files during build and use its values.</p>
<p>The phrase "environment variables" contributes to confusion, be careful. "Environment variables" are variables that you can pass from command line.</p>
<p>Here's what you should do:</p>
<ol>
<li>Remove all <strong>deploy target</strong> parameters from your code.</li>
<li>Move them into dotenv files. Make one dotnev file per <strong>deploy target</strong>. For example, <code>.env-production</code>, <code>.env-staging</code>, <code>.env-sandbox</code>, <code>.env-local</code>, <code>.env-mock</code>, etc. You can have as many as you need, not just production and development.</li>
<li>It is crucial that you gitigonre your dotenv files, so that your API keys do not get exposed through version control.</li>
<li>If you're using CI, you can copy variables from your dotenv files to your CI's online configuration. For example, the corresponding settings section in CodeShip is called "deployment pipelines".</li>
<li>Set up your app to accept a <strong>deploy target</strong> param, read the corresponding dotenv file and use values inside it. Most platforms have a <code>dotenv</code> library to do that.</li>
</ol>
<p>You're now able to select a <strong>deploy target</strong> separately from <strong>environment</strong>.</p>
<p>For example, when I need to run a produciton build against a local server I can do:</p>
<div class="code-block"><pre><code class="hljs">DEPLOY_TARGET=local ember serve --environment=production</code></pre></div>
<p>Of course, you can configure your app in such a way that a certain default <strong>deploy target</strong> is automatically selected for every <strong>environment</strong>. This will let you avoid redundancy in most common combinations.</p>
<p>You may object: we've come a full circle and now we are where we started: <strong>envrionment</strong> and <strong>deploy target</strong> are coupled. What's the point?</p>
<p>Yes, it is like that by default: your app will use development environment for local builds and production environment for deployments to production servers. But now you can override them and use any combination of <strong>environments</strong> and <strong>deploy tarets</strong> — without a need to modify your code and then roll back.</p>
<h3 id="how-to-configure-dotenv-in-ember" class="headingWithLink"><a href="#how-to-configure-dotenv-in-ember" class="headingWithLink-link">#</a>How to configure dotenv in Ember</h3>
<p>The <a href="https://www.npmjs.com/package/dotenv">dotenv</a> npm library can be used in Ember directly. But if you need to access your <strong>deploy target</strong> params both in <code>ember-cli-build.js</code> and <code>config/environment.js</code>, or in FastBoot, then you should use the <a href="https://github.com/fivetanley/ember-cli-dotenv">ember-cli-dotenv</a> addon.</p>
<p>Create <code>.env-</code> files in the root folder of your Ember CLI project, one per each backend you're using, including local and mock servers if you use them:</p>
<div class="code-block"><pre><code class="hljs">.env-production
.env-staging
.env-sandbox
.env-local
.env-mock</code></pre></div>
<p>A top-notch technique is to give your servers personal names. Using <code>.env-linode1</code> instead of <code>.env-production</code> will make things more clear.</p>
<p>Put <strong>deploy target</strong> configuration into each file like this:</p>
<div class="code-block"><pre><code class="hljs">MYAPP_BACKEND_API_URL=https://bravo.horns-and-hooves.com/api
MYAPP_BACKEND_API_VERSION=v18
MYAPP_IMAGES_CDN_URL=http://horns-and-hooves.cloudfront.net/bravo/images
MYAPP_GITHUB_API_KEY=jFViG9kZtY4NAJA8I65s</code></pre></div>
<p>Some of params may be shared across servers, that's fine.</p>
<p>You are recommended to prefix your variable names with your app name in order to prevent collisions with external env vars that you may also need.</p>
<p>No we need to teach <code>ember-cli-dotenv</code> load a specific dotenv file depending on our needs. Use this trick in your <code>config/environment.js</code> file:</p>
<div class="code-block"><pre><code class="javascript language-javascript hljs"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)

<span class="hljs-keyword">const</span> environment   = process.env.EMBER_ENV || <span class="hljs-string">'development'</span>
<span class="hljs-keyword">const</span> defaultTarget = environment === <span class="hljs-string">'production'</span> ? <span class="hljs-string">'production'</span> : <span class="hljs-string">'localhost-4200'</span>
<span class="hljs-keyword">const</span> target        = process.env.DEPLOY_TARGET || defaultTarget
<span class="hljs-keyword">const</span> dotEnvFile    = <span class="hljs-string">`./.env-<span class="hljs-subst">${target}</span>`</span>

<span class="hljs-keyword">if</span> (fs.existsSync(dotEnvFile)) <span class="hljs-built_in">console</span>.info(<span class="hljs-string">`using dotenv file: <span class="hljs-subst">${dotEnvFile}</span>`</span>)
<span class="hljs-keyword">else</span> <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">`dot-env file not found: <span class="hljs-subst">${dotEnvFile}</span>, assuming env vars are passed manually`</span>)



<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">env</span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">clientAllowedKeys</span> : [
      <span class="hljs-string">'MYAPP_BACKEND_API_URL'</span>,
      <span class="hljs-string">'MYAPP_BACKEND_API_VERSION'</span>,
      <span class="hljs-string">'MYAPP_IMAGES_CDN_URL'</span>,
      <span class="hljs-string">'MYAPP_GITHUB_API_KEY'</span>,
    ],
    <span class="hljs-attr">path</span> : dotEnvFile,
  }
}</code></pre></div>
<p>This will make the params from a given dotenv-file appear in the <code>process.env</code> hash, which in turn is available in <code>config/environment.js</code> and <code>ember-cli-build.js</code>. Use it like this:</p>
<div class="code-block"><pre><code class="js language-js hljs">{
  <span class="hljs-attr">gitHubApiKey</span>: process.env.MYAPP_GITHUB_API_KEY
}</code></pre></div>
<div class="exclamation"></div>
<blockquote>
  <p>Instead of accessing the <code>config/environment.js</code> in your app directly, create a <code>config</code> Ember service that will proxy the values from <code>config/environment.js</code>. Not only this will improve your app's architecture, it will also allow you have global computed properties derived from values read from <code>config/environment.js</code>.</p>
</blockquote>
<p>The above code will use <code>production</code> <strong>deploy target</strong> in the <code>production</code> <strong>environment</strong> and <code>localhost-4200</code> in <code>development</code>. You should adjust <strong>deploy target</strong> names used in the code by default.</p>
<div class="code-block"><pre><code class="sh language-sh hljs">ember s -prod   <span class="hljs-comment"># uses `production` environment with `production` deploy target</span>
ember s         <span class="hljs-comment"># uses `development` environment with `localhost-4200` deploy target</span></code></pre></div>
<p>Here's how you can tell which dotenv file to use:</p>
<div class="code-block"><pre><code class="sh language-sh hljs">DEPLOY_TARGET=localhost-4200 ember s -prod   <span class="hljs-comment"># uses `production` environment with `localhost-4200` deploy target</span>
DEPLOY_TARGET=production ember s             <span class="hljs-comment"># uses `development` environment with `production` deploy target</span></code></pre></div>
<h2 id="together-with-ember-cli-deploy" class="headingWithLink"><a href="#together-with-ember-cli-deploy" class="headingWithLink-link">#</a>Together with ember-cli-deploy</h2>
<p><code>ember-cli-deploy</code> <a href="http://ember-cli-deploy.com/docs/v1.0.x/using-env-for-secrets/">has built-in support for dotenv files</a>, but they're used only for <code>ember deploy</code> commands, whereas <code>ember-cli-dotenv</code> can be used both with <code>ember deploy</code> and default commands like <code>ember serve</code>, <code>ember build</code>, <code>ember test</code>, etc.</p>
<p>There are a number of gotchas you have to be aware of when you use <code>ember-cli-dotenv</code> together with <code>ember-cli-deploy</code>.</p>
<p>First of all, <code>ember-cli-deploy</code> docs use the phrase "build environment" as a synonym for <strong>deploy targets</strong>, which contributes to confusion.</p>
<p>Secondly, the <code>config/deploy.js</code> configuration file lets you define configuration based on <strong>deploy target</strong>. Rename <strong>deploy target</strong> names in the file to match the ones in your dotenv file names.</p>
<p>Thirdly, don't use short names like <code>dev</code> and <code>prod</code>. Use full names <code>development</code> and <code>production</code> or, even better, use unique names for your servers.</p>
<p>Fourthly, mind that <code>ember-cli-deploy</code> also uses the <code>DEPLOY_TARGET</code> env var. But for some reason it can't be used like this:</p>
<div class="code-block"><pre><code class="hljs">DEPLOY_TARGET=production ember deploy</code></pre></div>
<p>Instead, you're supposed to write</p>
<div class="code-block"><pre><code class="hljs">ember deploy production</code></pre></div>
<p>The trouble is that the <code>config/dotenv.js</code> files kicks in earlier than the <code>ember deploy production</code> command sets <strong>environment</strong> to <code>production</code> and assigns it to the <code>DEPLOY_TARGET</code> env var.</p>
<p>One solution is to pass the <code>DEPLOY_TARGET</code> variable explicitly for your <code>config/dotenv.js</code> to use:</p>
<div class="code-block"><pre><code class="hljs">DEPLOY_TARGET=production ember deploy production</code></pre></div>
<p>But this command is quite bulky. You can avoid the redundancy by teaching your <code>config/dotenv.js</code> to be aware of the <code>ember deploy production</code> command:</p>
<div class="code-block"><pre><code class="js language-js hljs"><span class="hljs-keyword">const</span> fs = <span class="hljs-built_in">require</span>(<span class="hljs-string">'fs'</span>)

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDeployTarget</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">return</span> process.env.DEPLOY_TARGET || getDefaultDeployTarget()
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">getDefaultDeployTarget</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">const</span> environment =
    process.env.EMBER_ENV
    || deployEnv()
    || <span class="hljs-string">'development'</span>

  <span class="hljs-keyword">return</span> environment === <span class="hljs-string">'production'</span> ? <span class="hljs-string">'production'</span> : <span class="hljs-string">'localhost-4200'</span>
}

<span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">deployEnv</span> (<span class="hljs-params"></span>) </span>{
  <span class="hljs-keyword">if</span> (process.argv[<span class="hljs-number">2</span>] === <span class="hljs-string">'deploy'</span> &amp;&amp; process.argv[<span class="hljs-number">3</span>] === <span class="hljs-string">'prod'</span>) {
    <span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">"Command `ember deploy prod` is not supported. Please use `ember deploy production`."</span>)
  } <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (process.argv[<span class="hljs-number">2</span>] === <span class="hljs-string">'deploy'</span> &amp;&amp; process.argv[<span class="hljs-number">3</span>] === <span class="hljs-string">'production'</span>) {
    <span class="hljs-keyword">return</span> <span class="hljs-string">'production'</span>
  }
}



<span class="hljs-keyword">const</span> dotEnvFile   = <span class="hljs-string">`./.env-<span class="hljs-subst">${getDeployTarget()}</span>`</span>

<span class="hljs-keyword">if</span> (fs.existsSync(dotEnvFile)) <span class="hljs-built_in">console</span>.info(<span class="hljs-string">`Using dotenv file: <span class="hljs-subst">${dotEnvFile}</span>`</span>)
<span class="hljs-keyword">else</span> <span class="hljs-built_in">console</span>.warn(<span class="hljs-string">`dot-env file not found: <span class="hljs-subst">${dotEnvFile}</span>, assuming env vars are passed manually`</span>)



<span class="hljs-built_in">module</span>.exports = <span class="hljs-function"><span class="hljs-keyword">function</span> (<span class="hljs-params">env</span>) </span>{
  <span class="hljs-keyword">return</span> {
    <span class="hljs-attr">clientAllowedKeys</span> : [
      <span class="hljs-string">'MYAPP_BACKEND_API_URL'</span>,
      <span class="hljs-string">'MYAPP_BACKEND_API_VERSION'</span>,
      <span class="hljs-string">'MYAPP_IMAGES_CDN_URL'</span>,
      <span class="hljs-string">'MYAPP_GITHUB_API_KEY'</span>,
    ],
    <span class="hljs-attr">path</span> : dotEnvFile,
  }
}</code></pre></div>
<p>As a result, the <code>ember deploy production</code> command will use the <code>.env-production</code> dotenv file and set the <strong>environment</strong> to <code>production</code>.</p>
<p>When you need to deploy a development build (e. g. with no minification) to production, use this command:</p>
<div class="code-block"><pre><code class="hljs">EMBER_ENV=development ember deploy production</code></pre></div>
<h2 id="your-opinion" class="headingWithLink"><a href="#your-opinion" class="headingWithLink-link">#</a>Your opinion?</h2>
<p>Don't hesitate to share what you have to say in the comments!</p>
</div>
</div>

<!---->
</div>

  
</div></div>


</div>

  </div>

</div></div><script type="fastboot/shoebox" id="shoebox-ember-data-store">{"types":{"cache-buster":[{"data":{"id":"buster","attributes":{"string":"61e6c79273e8a6d750b38a3ccf881b7a52a816cf9410a1af441823157101e378"},"type":"cache-busters"}}],"experience":[],"markdown-block":[],"post":[{"data":{"id":"do-not-confuse-env-for-deploy-target-en","attributes":{"title":"Do not confuse environment for deploy target","body":"\n\u003cdiv class=\"exclamation\"\u003e\u003c/div\u003e\n\n\u003e This article was originally posted on Deveo blog.\n\u003e \n\u003e When Deveo was acquired by Perforce, Deveo blog was turned down.\n\nI'm seeing the term **environment** used as a synonym of **deploy target** all the time. I believe, it causes a lot of confusion, and I would like clear it up.\n\nThis article is written with the **EmberJS** frontend framework in mind, but the idea is applicable to any other web framework, both frontend and backend.\n\n\n\n## The term Environment is too vague\n\nThere are many articles on the web that may seem to contradict to what I'm gonna say, especially if you skim them without giving them deep consideration. Those articles have been frustrating to me for a long time, until I figured that the problem is that terminology is confusing.\n\nIn **EmberJS** and many other web frameworks the term **environment** is used in a narrow meaning, and I'm gonna use this very meaning below. **Environment** is a collection of parameters that configure how your wep app is built and run, such as:\n\n*   code minification,\n*   asset fingerprinting/cache busting,\n*   source map generation,\n*   various debugging tools,\n*   testing,\n*   applying code coverage markers,\n*   removing test selectors from HTML.\n\nThere is another category of parameters, that is commonly referenced as **environment**. I believe that's a terrible mistake, and the second category must be distinguished from **environment**.\n\nI call it **deploy target**. It includes the following params:\n\n*   API URLs,\n*   CDN URLs,\n*   CSP/CORS configuration,\n*   API keys.\n\n\n\n## Why is mixing these categories a problem?\n\nMany developers put those two categories of params into one pile and make them depend on the **environment** variable, which in most frameworks can have one of three values: `development`, `production` and `test`.\n\nAs a result, the app essentially has only two modes:\n* production build to production server,\n* development build to development server.\n\nA necessity to deploy a development build to a production server is not rare. You typically need that to debug a problem that only manifestates on the server and can't be reproduced locally.\n\nThe opposite is also sometimes necessary: to make a production build against a local server. It can help you to benchmark your app's performance or to debug a problem with minification/fingerprinting.\n\nWhen you have your **environment** and **deploy target** hard-wired, the only way to decouple them is to edit your configuration files by hand, make the unusual build, then undo your changes and make sure you don't accidentally commit them.\n\nThe worst part is that API keys are typically stored in your VCS, which is a security issue.\n\n\n\n## The right way to do it\n\nI recommend you to use *dotenv* files.\n\nDotenv files are configuration files with names that start with `.env-` prefix. They store environment variable definitions as key=value pairs, one per line:\n    \n```\nFOO=bar\nBAZ=quux\n```\n\nYour app will read one of those files during build and use its values.\n\nThe phrase \"environment variables\" contributes to confusion, be careful. \"Environment variables\" are variables that you can pass from command line.\n\nHere's what you should do:\n\n1. Remove all **deploy target** parameters from your code.\n2. Move them into dotenv files. Make one dotnev file per **deploy target**. For example, `.env-production`, `.env-staging`, `.env-sandbox`, `.env-local`, `.env-mock`, etc. You can have as many as you need, not just production and development.\n3. It is crucial that you gitigonre your dotenv files, so that your API keys do not get exposed through version control.\n4. If you're using CI, you can copy variables from your dotenv files to your CI's online configuration. For example, the corresponding settings section in CodeShip is called \"deployment pipelines\".\n5. Set up your app to accept a **deploy target** param, read the corresponding dotenv file and use values inside it. Most platforms have a `dotenv` library to do that.\n\nYou're now able to select a **deploy target** separately from **environment**.\n\nFor example, when I need to run a produciton build against a local server I can do:\n\n    DEPLOY_TARGET=local ember serve --environment=production\n\nOf course, you can configure your app in such a way that a certain default **deploy target** is automatically selected for every **environment**. This will let you avoid redundancy in most common combinations.\n\nYou may object: we've come a full circle and now we are where we started: **envrionment** and **deploy target** are coupled. What's the point?\n\nYes, it is like that by default: your app will use development environment for local builds and production environment for deployments to production servers. But now you can override them and use any combination of **environments** and **deploy tarets** — without a need to modify your code and then roll back.\n\n\n\n### How to configure dotenv in Ember\n\nThe [dotenv](https://www.npmjs.com/package/dotenv) npm library can be used in Ember directly. But if you need to access your **deploy target** params both in `ember-cli-build.js` and `config/environment.js`, or in FastBoot, then you should use the [ember-cli-dotenv](https://github.com/fivetanley/ember-cli-dotenv) addon.\n\nCreate `.env-` files in the root folder of your Ember CLI project, one per each backend you're using, including local and mock servers if you use them:\n\n    .env-production\n    .env-staging\n    .env-sandbox\n    .env-local\n    .env-mock\n\nA top-notch technique is to give your servers personal names. Using `.env-linode1` instead of `.env-production` will make things more clear.\n\nPut **deploy target** configuration into each file like this:\n\n    MYAPP_BACKEND_API_URL=https://bravo.horns-and-hooves.com/api\n    MYAPP_BACKEND_API_VERSION=v18\n    MYAPP_IMAGES_CDN_URL=http://horns-and-hooves.cloudfront.net/bravo/images\n    MYAPP_GITHUB_API_KEY=jFViG9kZtY4NAJA8I65s\n\nSome of params may be shared across servers, that's fine.\n\nYou are recommended to prefix your variable names with your app name in order to prevent collisions with external env vars that you may also need.\n\nNo we need to teach `ember-cli-dotenv` load a specific dotenv file depending on our needs. Use this trick in your `config/environment.js` file:\n\n```javascript\nconst fs = require('fs')\n\nconst environment   = process.env.EMBER_ENV || 'development'\nconst defaultTarget = environment === 'production' ? 'production' : 'localhost-4200'\nconst target        = process.env.DEPLOY_TARGET || defaultTarget\nconst dotEnvFile    = `./.env-${target}`\n\nif (fs.existsSync(dotEnvFile)) console.info(`using dotenv file: ${dotEnvFile}`)\nelse console.warn(`dot-env file not found: ${dotEnvFile}, assuming env vars are passed manually`)\n\n\n\nmodule.exports = function (env) {\n  return {\n    clientAllowedKeys : [\n      'MYAPP_BACKEND_API_URL',\n      'MYAPP_BACKEND_API_VERSION',\n      'MYAPP_IMAGES_CDN_URL',\n      'MYAPP_GITHUB_API_KEY',\n    ],\n    path : dotEnvFile,\n  }\n}\n```\n\nThis will make the params from a given dotenv-file appear in the `process.env` hash, which in turn is available in `config/environment.js` and `ember-cli-build.js`. Use it like this:\n\n```js\n{\n  gitHubApiKey: process.env.MYAPP_GITHUB_API_KEY\n}\n```\n\n\u003cdiv class=\"exclamation\"\u003e\u003c/div\u003e\n\n\u003e Instead of accessing the `config/environment.js` in your app directly, create a `config` Ember service that will proxy the values from `config/environment.js`. Not only this will improve your app's architecture, it will also allow you have global computed properties derived from values read from `config/environment.js`.\n\nThe above code will use `production` **deploy target** in the `production` **environment** and `localhost-4200` in `development`. You should adjust **deploy target** names used in the code by default.\n\n```sh\nember s -prod   # uses `production` environment with `production` deploy target\nember s         # uses `development` environment with `localhost-4200` deploy target\n```\n\nHere's how you can tell which dotenv file to use:\n\n```sh\nDEPLOY_TARGET=localhost-4200 ember s -prod   # uses `production` environment with `localhost-4200` deploy target\nDEPLOY_TARGET=production ember s             # uses `development` environment with `production` deploy target\n```\n\n\n\n\n## Together with ember-cli-deploy\n\n`ember-cli-deploy` [has built-in support for dotenv files](http://ember-cli-deploy.com/docs/v1.0.x/using-env-for-secrets/), but they're used only for `ember deploy` commands, whereas `ember-cli-dotenv` can be used both with `ember deploy` and default commands like `ember serve`, `ember build`, `ember test`, etc.\n\nThere are a number of gotchas you have to be aware of when you use `ember-cli-dotenv` together with `ember-cli-deploy`.\n\nFirst of all, `ember-cli-deploy` docs use the phrase \"build environment\" as a synonym for **deploy targets**, which contributes to confusion.\n\nSecondly, the `config/deploy.js` configuration file lets you define configuration based on **deploy target**. Rename **deploy target** names in the file to match the ones in your dotenv file names.\n\nThirdly, don't use short names like `dev` and `prod`. Use full names `development` and `production` or, even better, use unique names for your servers.\n\nFourthly, mind that `ember-cli-deploy` also uses the `DEPLOY_TARGET` env var. But for some reason it can't be used like this:\n\n    DEPLOY_TARGET=production ember deploy\n    \nInstead, you're supposed to write\n\n    ember deploy production\n    \nThe trouble is that the `config/dotenv.js` files kicks in earlier than the `ember deploy production` command sets **environment** to `production` and assigns it to the `DEPLOY_TARGET` env var.\n\n One solution is to pass the `DEPLOY_TARGET` variable explicitly for your `config/dotenv.js` to use:\n\n    DEPLOY_TARGET=production ember deploy production\n\n\n But this command is quite bulky. You can avoid the redundancy by teaching your `config/dotenv.js` to be aware of the `ember deploy production` command:\n\n```js\nconst fs = require('fs')\n\nfunction getDeployTarget () {\n  return process.env.DEPLOY_TARGET || getDefaultDeployTarget()\n}\n\nfunction getDefaultDeployTarget () {\n  const environment =\n    process.env.EMBER_ENV\n    || deployEnv()\n    || 'development'\n\n  return environment === 'production' ? 'production' : 'localhost-4200'\n}\n\nfunction deployEnv () {\n  if (process.argv[2] === 'deploy' \u0026\u0026 process.argv[3] === 'prod') {\n    throw new Error(\"Command `ember deploy prod` is not supported. Please use `ember deploy production`.\")\n  } else if (process.argv[2] === 'deploy' \u0026\u0026 process.argv[3] === 'production') {\n    return 'production'\n  }\n}\n\n\n\nconst dotEnvFile   = `./.env-${getDeployTarget()}`\n\nif (fs.existsSync(dotEnvFile)) console.info(`Using dotenv file: ${dotEnvFile}`)\nelse console.warn(`dot-env file not found: ${dotEnvFile}, assuming env vars are passed manually`)\n\n\n\nmodule.exports = function (env) {\n  return {\n    clientAllowedKeys : [\n      'MYAPP_BACKEND_API_URL',\n      'MYAPP_BACKEND_API_VERSION',\n      'MYAPP_IMAGES_CDN_URL',\n      'MYAPP_GITHUB_API_KEY',\n    ],\n    path : dotEnvFile,\n  }\n}\n```\n\nAs a result, the `ember deploy production` command will use the `.env-production` dotenv file and set the **environment** to `production`.\n\nWhen you need to deploy a development build (e. g. with no minification) to production, use this command:\n\n    EMBER_ENV=development ember deploy production\n\n\n\n## Your opinion?\n\nDon't hesitate to share what you have to say in the comments!\n\n","summary":"Most frameworks have a concept of *environment*. Many developers are misusing it as a deploy target.","image":null,"created":"2017-02-18T00:00:00.000Z","updated":"2017-12-24T00:00:00.000Z","hide-summary":false,"dependencies":null,"proficiency":"beginner"},"type":"posts"}}],"project-info":[],"project":[],"stackoverflow-user":[]}}</script>

    <script src="/assets/vendor-8fa103718f5228bbbf0e48134e96adcd.js" integrity="sha256-PNNj4JHm7k/vT170qeRgv+RPJpKZmN1JEiqQhed5LKg= sha512-YfbY2HN42G+vNVK15tKzxaGmwVHrPangnBAY5i38NtVF3MxdmBYx5eDd1/b5UGMbqE0CqQ6cE5LZiFKnVXvfAg==" ></script>
    <script src="/assets/lolma-us-be4b92b2e227e4641edf880f467b4f96.js" integrity="sha256-IdRe43Hzo86CxCFau0DEvc/EdTeTqKpZb4VCLtcdkyg= sha512-2oY/tj/JByJi8hKe+FV4ggaA9kOrTnE2Es6BLT3ZXKfNFCSuwdNY1pHsxewKrI4VXXVXxPr0QUdAUSDI1mOHmw==" ></script>

    
  </body>
</html>
